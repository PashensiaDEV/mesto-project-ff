(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e,t,n,o){var r=d.querySelector(".places__item").cloneNode(!0),c=r.querySelector(".card__image");c.src=e.link,c.alt=e.name,r.querySelector(".card__title").textContent=e.name,r.querySelector(".like-counter").textContent=e.likes.length,c.addEventListener("click",(function(){o(e)}));var i=r.querySelector(".card__delete-button"),a=r.querySelector(".card__like-button");return t(i),n(a),r}function n(e){e.addEventListener("click",(function(){var t=e.closest(".places__item");console.log(t),t&&t.remove()}))}function o(e){e.addEventListener("click",(function(){e.classList.toggle("card__like-button_is-active")}))}function r(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",i)}function c(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&c(document.querySelector(".popup_is-opened"))}e.d({},{v:()=>d,G:()=>l});var a=function(e,t){u(e)?(t.classList.add(l.inactiveButtonClass),t.disabled=!0):(t.classList.remove(l.inactiveButtonClass),t.disabled=!1)},u=function(e){return e.some((function(e){return!e.validity.valid}))},l={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"button_inactive",inputErrorClass:"form__input_type_error",errorClass:"form__input-error_active",errorClassDissable:".form__input-error"},s="https://nomoreparties.co/v1/",p="4601d008-a405-4f80-81df-1bf2249ca44f",d=document.querySelector("#card-template").content,f=document.querySelector(".places__list"),_=document.querySelector(".popup_type_image"),m=_.querySelector(".popup__image"),v=_.querySelector(".popup__caption"),y=document.querySelector(".popup_type_edit"),S=document.querySelector(".popup_type_new-card"),h=S.querySelector('form[name="new-place"]'),q=y.querySelector('form[name="edit-profile"]'),C=y.querySelector(".popup__input_type_name"),b=y.querySelector(".popup__input_type_description"),E=document.querySelector(".profile__edit-button"),L=document.querySelector(".profile__add-button"),k=document.querySelector(".profile__title"),g=document.querySelector(".profile__description"),x=document.querySelector(".profile__image"),w=S.querySelector(".popup__input_type_card-name"),j=S.querySelector(".popup__input_type_url");function A(e){f.prepend(e)}function O(e){m.src=e.link,m.alt=e.name,v.textContent=e.name,r(_)}E.addEventListener("click",(function(){b.value=g.textContent,C.value=k.textContent,r(y),function(e,t){var n=e.querySelectorAll(t.errorClassDissable),o=e.querySelectorAll(t.inputSelector);n.forEach((function(e){e.classList.remove(t.errorClass),e.textContent=""})),o.forEach((function(e){e.classList.remove(t.inputErrorClass)}))}(q,l)})),L.addEventListener("click",(function(){r(S)})),document.querySelectorAll(".popup").forEach((function(e){e.addEventListener("click",(function(t){(t.target.classList.contains("popup__close")||t.target.classList.contains("popup"))&&c(e)}))})),h.addEventListener("submit",(function(e){e.preventDefault();var r,i,a={};a.name=w.value,a.link=j.value,A(t(a,n,o,O)),c(S),h.reset(),(r=w.value,i=j.value,fetch("".concat(s,"wff-cohort-38/cards"),{method:"POST",headers:{authorization:p,"Content-Type":"application/json"},body:JSON.stringify({name:r,link:i})}).then((function(e){return e.json()}))).then((function(e){var r={name:e.name,link:e.link,likes:e.likes};console.log(e);var i=t(r,n,o,O);f.prepend(i),c(S),h.reset()}))})),q.addEventListener("submit",(function(e){var t,n;e.preventDefault(),k.textContent=C.value,g.textContent=b.value,c(y),(t=C.value,n=b.value,fetch("".concat(s,"wff-cohort-38/users/me"),{method:"PATCH",headers:{authorization:p,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then((function(e){return e.json()}))).then((function(e){k.textContent=e.name,g.textContent=e.about})).catch((function(e){console.log(e)})),c(y)})),Array.from(document.querySelectorAll(l.formSelector)).forEach((function(e){e.addEventListener("submit",(function(e){e.preventDefault()})),function(e){var t=Array.from(e.querySelectorAll(l.inputSelector)),n=e.querySelector(l.submitButtonSelector);a(t,n),t.forEach((function(o){o.addEventListener("input",(function(){(function(e,t){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?function(e,t){var n=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(l.inputErrorClass),n.classList.remove(l.errorClass),n.textContent=""}(e,t):function(e,t,n){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(l.inputErrorClass),o.textContent=n,o.classList.add(l.errorClass)}(e,t,t.validationMessage)})(e,o),a(t,n)}))}))}(e)})),fetch("".concat(s,"wff-cohort-38/users/me"),{method:"GET",headers:{authorization:p}}).then((function(e){return e.json()})).then((function(e){k.textContent=e.name,g.textContent=e.about,x.style.backgroundImage="url(".concat(e.avatar,")")})),fetch("".concat(s,"wff-cohort-38/cards"),{method:"GET",headers:{authorization:p}}).then((function(e){return e.json()})).then((function(e){e.forEach((function(e){A(t(e,n,o,O))}))}))})();